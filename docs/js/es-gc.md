---
title: 垃圾回收
order: 6
group:
  title: es
---

[V8 垃圾回收算法](https://juejin.cn/post/6844904016325902344)

##### 垃圾回收算法

> ###### 引用计数：
>
> 概念：记录引用次数
> 优点：1. 及时回收垃圾对象 2. 减少卡顿
> 缺点：1. 资源消耗大 2. 无法回收循环引用对象
>
> ###### 标记清除：
>
> 概念：找到可达对象并标记，清除没有标记的对象，回收空间
> 优点：可以回收循环引用的对象
> 缺点：1. 空间碎片化 2. 不能立即回收对象
>
> ###### 标记整理：
>
> 优点：最大化利用空间
> 缺点：不能立即回收垃圾对象
>
> ###### 标记增量
>
> 概念：老生代存活对象多，垃圾回收时间长，全停顿造成的影响大，v8 对标记进行了优化，将一次停顿的标记过程分成多步

##### 浏览器垃圾回收

> 引用计数、标记清除

##### v8 垃圾回收

> ###### 新生代
>
> 概念：对象存活时间短，存储新生对象或只经过一次垃圾回收的对象
> 主要算法：复制算法、标记整理
> <Badge type="error">tips：空间换取时间</Badge>
>
> ###### 对象晋升
>
> 1. 是否经历过一次 Scavenge 算法（复制之前检测对象的内存地址是否发生了变更，如变更则转移到老生代）
> 2. To 空间的占比是否超过 25%
>
> ###### 老生代
>
> 概念：对象存活时间长，经历过一次或多次垃圾回收的对象
> 主要算法：标记清除、标记整理、（标记增量、延迟清理、增量式整理）、（并行标记、并行清理）
>
> <Badge type="error">tips：标记增量、延迟清理、增量式整理是将标记整理算法的标记、整理、清理过程变为增量式，此外并行标记和并行清理是充分利用多核 CPU 的性能进一步减少垃圾回收对主线程的影响。</Badge>

##### 解决方案

> 1. 减少创建全局变量
> 2. 手动清除定时器
> 3. 少用闭包
> 4. 手动清除 DOM 引用
> 5. 弱引用
